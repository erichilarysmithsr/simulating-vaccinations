\documentclass[11pt]{article}
\usepackage{geometry}                
\geometry{letterpaper}                   

\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf}
\usepackage{natbib}
\usepackage{amssymb, amsmath}
\usepackage{listings}
\graphicspath{ {./images/} }
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}

\title{Simulating Vaccinations}
\author{Hannah Niese, Markus Niese, Timo Schönegg}
\date{24.11.2018} 

\begin{document}


\input{cover}
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\section*{Agreement for free-download}
\bigskip


\bigskip


\large We hereby agree to make our source code for this project freely available for download from the web pages of COSS. Furthermore, we assure that all source code is written by ourselves and is not violating any copyright restrictions.

\begin{center}

\bigskip


\bigskip


\begin{tabular}{@{}p{0.5cm}@{}p{6cm}@{}p{6cm}@{}p{6cm}@{}p{1cm}}
\begin{minipage}{1cm}

\end{minipage}
&
\begin{minipage}{5cm}
\vspace{2mm} \large Hannah Niese

 \vspace{\baselineskip}

\end{minipage}
&
\begin{minipage}{5cm}

\large Markus Niese

\end{minipage}
&
\begin{minipage}{5cm}

\large Timo Schönegg

\end{minipage}
&
\begin{minipage}{1cm}

\end{minipage}

\end{tabular}


\end{center}
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



% IMPORTANT
% you MUST include the ETH declaration of originality here; it is available for download on the course website or at http://www.ethz.ch/faculty/exams/plagiarism/index_EN; it can be printed as pdf and should be filled out in handwriting


%%%%%%%%%% Table of content %%%%%%%%%%%%%%%%%

\tableofcontents

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\section{Abstract}



\section{Individual contributions}

\section{Introduction and Motivations}

Vaccines are without doubt one of the greatest advances in medicine, whose widespread use has lead to the eradication or restriction of some of the deadliest diseases, including smallpox, polio and measles. Every vaccination carries a small risk of side effects. According to the WHO, severe adverse events are extremely rare for most vaccines (for the Hepatitis B vaccine only one in a million is affected) or not yet clinically proven like in the case of Hepatitis A.\footnote{WHO (2018-10-06), $http://www.who.int/vaccine_safety/initiative/tools/vaccinfosheets/en/$}  However, contested medical papers and rumours have led to a reluctance to vaccinate in parts of the society.

\vspace{14px}

We modelled the specific case of Pertussis or Whooping cough, as there have been several incidents where a rising number of infections have been observed despite relatively high vaccination rates. One of these cases is the Netherlands, where, despite a coverage rate of 95\% several cases of Pertussis have been registered. One of the reasons is waning immunisation and the lack of people getting vaccinated. Even though these cases might be few, the survival of the disease means that the coverage rate should remain high. 

This paper tries to answer the question of how people take decisions on whenther to get vaccinated or not, and how the dynamics of the disease changes. 

\begin{center}
\includegraphics[scale=0.4]{ukpertussis}
\end{center}


\section{Description of the Model}

\subsection{SIR Model}

We used an SIR model for the simulation of the spreading of Pertussis. Pertussis is transmitted by respiratory droplets human-to-human with an incubation period ranging from 9 to 14 days, while symptoms can last up to 6 weeks. \footnote{Torres Codeço, C; Mendes Luz, P; Is pertussis actually reemerging? Insights from an individual-based model, Cad. Saúde Pública vol.17 no.3 Rio de Janeiro May/June 2001}

\begin{lstlisting}
#probability of infection from outside sources
prob_for_diseases = 0.001 
prob_for_contact_infection = 0.5
\end{lstlisting}

This estimation is taken from a simulation which assesses the susceptibility of family members. We assume that a person has frequent contact with close family members and modulate the outcome with another variable that uses the probability that you meet with someone from your network on a given day to depict a realistic depiction of the society. 
\footnote{Estimation of Household Transmission Rates of Pertussis and the Effect of Cocooning Vaccination Strategies on Infant Pertussis Epidemiology 23(6):852-860, November 2012}
\vspace{14px}

Markus
\vspace{14px}

In our model individuals have the choice of vaccinating or not. They do that based on the current benefits of each option. The main parameters infulincing their decision are the perceived risk of side effects of the vaccination r\_v and perceived risk to get harmed by the disease r\_i. 
These two parameters do not just have to be caused by one specific reason but can be composed of a number of factors. Certainly the actual risks play a part, but equally the perceived risk, which will rise for example when individuals in the neigborhood are infected. But also financial consideration may play a part. We will elaborate on the possible influences in Chapter….
Furthermore we will assume that the disease can only be transmitted by humans. Childhood diseases like pertussis or measles are of that kind. Diseases like Cholera of Malaria can also infect someone if nobody else is infected. This sort of diseases will not be looked at in our initial model. We will however incorporate that possibility later. 
The probability to get infected PI\_i is primarily determined by the proportion of people that are currently infected l\_i and the proportion of people that are vaccinated l\_c


\subsubsection{Modelling immunisation}
We assume that the vaccination provides 100\% safety, equal to having recovered from the disease. However, as recent research has shown that the protection considerably decreases about 10  years after the initial protection. 
To simplify the length of the protection acquired either by being vaccinated or by having recovered from Pertussis, we take a period of 13 years with a standard deviation of 2 years, which is on the conservative side, given that only 10\% of those vaccinated are still protected 12 years after the vaccination. There is less data available to assess the immunity after having recovered from the disease, but it can be assumed to be similar to the immunity acquired by vaccination. In addition we analyse a society with a high rate of coverage, so that the majority will have acquired their immunity by vaccination. \footnote{Wendelboe, Van, Salmaso, Englund: Duration of immunity against pertussis after natural infection or vaccination. S58–S61} 
As this dynamics of waning immunity already provides us with a constant population, we do not model births and deaths, as Pertussis is not a disease that frequenly causes death. 

\subsection{Network}

The main model of our project uses a complex network representing the contacts of each person. The vertices are the individuals in the simulation and each edge is a contact between the two people. We worked with undirected networks in all our simulations. The transmission of a disease, at least in the case of pertussis, occurs if and only if the two individuals have direct contact. Meaning if Person A has contact to Person B, then Person B has automatically also contact to Person A. That context is better represented by an undirected network. However, our simulation works for directed networks as well.
All networks we used were also connected, which means that there is a path between each two vertices. All social networks nowadays are that way, in particular small sized systems like in our simulation. Moreover, unconnected individuals do not play a role as the disease can only be transmitted by human contact.

As studied by Barabasi, \footnote{INSERT REFERENCE BARABASI} randomly generated graphs are not a good representation of real human networks as some people will have contact to many more people than average, while most will have contact to far fewer individuals. That is because people with a large number of contacts are more likely to connect with even more people. That means real human networks exhibit so called scale-free behavior, meaning that the degree distribution falls by some polynomial rather than being constant like in a completely random network. The Barabasi-Albert-Network reaches that by sequentially adding single nodes each with two new edges connecting randomly, but with a preference to nodes with a higher degree, to the already existing nodes. Using that process, a degree distribution of $k^{-3}$ is reached. We did create our own generator which builds a network after the Barabasi-Albert-Model. However, due to considerable runtime length we used the Barabasi-Albert-Generator from the Python Module Networkx for most of our simulation, especially for those with a high number of vertices.

General Principle of the Simulation
The program is based on an object-oriented approach. That means the main program is executed by objects of class Person in vacc.py. Each Person is one individual in our model. There are three derived classes each corresponding to way of simulating the interactions between those individuals:

1	Grid\_Person: Places people on a two$-$dimensional plane, where each pixel stands for one Person. Not a very realistic model, but allows for nice graphical representations and animations.

2	Network\_Person: More realistic and thus the one used for the whole analysis. Every Network\_Person has an adjacency list of all its contacts and can only interact with those.
In every timestep a couple of memberfunctions are called to refresh the status of each Person.
Next\_day(): checks, if immunization or infection is still active and refreshes the corresponding variables if not
Get\_vaccinated(): Each Person decides everyday, if it should vaccinated dependend on the expected gain for this individual. The details of that can be found in chapter
Start\_infecteion(probability\_to\_meet): if the Person is infected, it itself can infect people. Therefore it must meet them (determined by the probability to meet) and if the two people meet, the infection will happen with a certain probability prob\_for\_contact\_infection.



Initialisation for long time analysis:
The main goal of the long-term analysis is to investigate if and when the disease can reemerge. To model this, a few new functions and parameters are needed. The immunization has a finite length. According to papers pertussis immunization irrelevant if due to vaccination or recovery stays active for around 12 years. We approximate the length of each individual’s immunity by a gaussian with a mean of 12 years and a standard deviation of two years. The individual obviously does not know, if he is still immune, but can vaccinate again after 8 years. That is consistent with recommendations from health organisations. What we also introduce is a random probability to be infected. Pertussis is only transmitted by other humans. However, that random probability is needed as the disease would die out quickly due to the small size of our system. So this probability represents people in our system having contact with someone from outside and bringing the disease in. The last but arguably most important parameters are the perceived cost due to vaccination and infection. There exists very little public research on that, meaning we had to investigate it ourselves. The first problem is that no one vaccinates if nobody is infected. That is evidently false, so we set the infection level to a minimum of 0.1 percent, corresponding to the probability to get infected by an outside person.
Considering now the numerical values for the costs it becomes apparent that the absolute values do not matter but only the relation between the two costs. Thus, we set the perceived vaccination cost arbitrarily to 1. We find the perceived infection cost by going back to our initial assumption that there is a voluntary vaccination policy at place. That means that the initial perceived infection cost is related to the initial coverage level in our system. If for example initially 97\% of the people are vaccinated, we set the perceived vaccination cost in such a way that the expected gain due to vaccination is slightly negative for every person exceeding the 97\% coverage level.
Letting that model run yields no results, as it operates in an equilibrium. As soon as one person’s immunization becomes inactive it will immediately vaccinate again, such that the coverage level is always constant. That is also very consistent with the real situation. If 97\% have decided to vaccinate and the opinion of everybody stays the same they will immediately vaccinate again if they lose immunization.
That means we have to introduce vaccination scares. At variable times we change the perceived cost of vaccination of some proportion of the population just like a anti-vaccine newspaper article or television documentary for example would.


\subsection{Vaccination Decision}

We assume that every person is a rational decision maker, who decides whether or not to get vaccinated based on the perceived costs of getting vaccination vs risking getting sick.  \footnote{INSERT RESEACH ABOUT 12 YEARS HERE}  

has an initial inclination to vaccinate themselves, which we initialise before the simulation. 


\textbf{Cost functions}
To evaluate the probability of a person to get vaccinated, we use a static model in which each individual assesses their personal cost of getting vaccinated versus getting infected. 


\subsubsection{Perceived vaccination cost} 


\subsubsection{Perceived infection cost}
The perceived vaccination cost of a person changes in two scenarios:

1. When someone in the immediate surroundings is infected, the perceived infection cost rises by a factor of 1.2 (after recovery of the contact it decreases by 0.9).

2. When the global level of 

\subsection{One person among N people}
To illustrate this, let us have a look how a person A takes the decision to vaccinate: 
We initialise each person with a value for perceived vaccination cost and perceived infection cost (which are the same for everyone at the beginning. 
If a person B in the network of A falls ill, A's perceived infection cost rises by a factor of 1.2. If another person C in A's network were to fall ill, A'S perceived infection cost would rise by a factor of 1.2 again. After person B recovers, A's perceived infection cost are multiplied by a factor of 0.9, the same is true when person C recovers, leaving person A with a perceived risk of infection of 1.1664 compared to 1 at the beginning, accounting for the fact that the person is more aware of the cost of the disease because B and C in their network have been affected. 

\subsection{Equilibria for N people}
In addition to the "local" information of the nodes in the network of the person, there is also information on the general coverage and infection level in society available to the individual, as well as an additional factor that we call 

change\_infection\_cost\_population

\begin{small}
\begin{lstlisting}
def change_infection_cost_population(people_list, factor, probability):
    """ Change the percieved_infec_cost by a factor for every Person
    with some probability
    
    Args:
        people_list (list of Person): 
        The list of people whose parameter should be changed
        factor (float): 
        The factor by which the percieved_infec_cost should be changed
        probability (float, between 0 and 1): 
        probability of each person to get the percieved_infec_cost changed
    
    Returns:
        people_list (list of Person): 
        The list of people whose parameter have been changed
    """

\end{lstlisting}
\end{small}


\subsection{Important Parameters}
First we look at the dynamics of the disease. Pertussis is highly contagious, and is transmitted via the respiratory organs. Sneezing, coughing or even speaking can release enough infected particles to cause the disease, making crowded spaces such as public transport and educational institutions ideal for transmission. We therefore initialised everyone in the network to have 40 connections, of which he or she meets 40\% every day, which seems realistic given that even a short encounter on a train station might cause the disease. 
\begin{lstlisting}
#Random probability (per day and person) to become sick 
#without being infected by someone else
prob_for_diseases = 0.00003 

#probability to infect someone when there is contact
prob_for_contact_infection = 0.5 

#incubation time (in days)
incubation_time = 10
 
#days from infection, after this time a person is recovered
time_to_get_healthy = 10 
\end{lstlisting}

The patient starts being infectious 7 days after infection, and remains so until they recover \footnote{Bundeszentrale für Gesundheitliche Aufklärung Germany, Keuchhusten \break
$www.infektionsschutz.de/erregersteckbriefe/keuchhusten/\#c3580$, accessed 30.11.2018}

\section{Implementation}
The model was implemented using Python. First, we wrote the basic SIR model with infection and recovery. Then we added the "vaccination function" which returns whether a person is getting vaccinated or not. Finally, 

\vspace{14px}



\subsection{SIR Model Implementation}


\section{Simulation Results and Discussion}

\subsection{Limitations}

\subsection{Algorithm Performance}

\section{Summary and Outlook}

\section{References}
Table of References: 
\vspace{14px}

Bauch, C. T., \& Earn, D. J. (2004). Vaccination and the theory of games. Proceedings of the National Academy of Sciences, 101(36), 13391-13394.
\vspace{14px}

Eshel, I. (1996). On the changing concept of evolutionary population stability as a reflection of a changing point of view in the quantitative theory of evolution. Journal of mathematical biology, 34(5-6), 485-510.
\vspace{14px}

Heal, G., \& Kunreuther, H. (2005). The vaccination game. Risk Management and Decision Processes Center Working Paper, (05-10). 
\vspace{14px}

Estimation of Household Transmission Rates of Pertussis and the Effect of Cocooning Vaccination Strategies on Infant Pertussis Epidemiology23(6):852-860, November 2012

Wendelboe AM, Van RA, Salmaso S, Englund JA: Duration of immunity against pertussis after natural infection or vaccination. Pediatr Infect Dis J 2005; 24(5 Suppl): S58–S61

Torres Codeço, C; Mendes Luz, P; Is pertussis actually reemerging? Insights from an individual-based model, Cad. Saúde Pública vol.17 no.3 Rio de Janeiro May/June 2001
\vspace{14px}

$https://ourworldindata.org/vaccination$ 
\vspace{14px}

$https://www.gapminder.org/data/$ search for 'vaccine'
\vspace{14px}

Immunization coverage, system indicators and schedule, and disease incidence $www.who.int/immunization/monitoring_surveillance/data/en$


\newpage




\end{document}  



 
